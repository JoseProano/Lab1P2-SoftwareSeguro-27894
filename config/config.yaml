# Database Configuration
database:
  mongo_uri: "mongodb://admin:secure_password_123@mongodb:27017/"
  db_name: "vulnerability_db"
  collections:
    cve: "cve_data"
    nvd: "nvd_vulnerabilities"
    github: "github_advisories"
    code_metrics: "code_metrics"
    predictions: "vulnerability_predictions"

# Data Collection
data_collection:
  cve:
    source_path: "/app/cve_data/2025"
    batch_size: 100
  nvd:
    api_url: "https://services.nvd.nist.gov/rest/json/cves/2.0"
    results_per_page: 100
    rate_limit: 5  # requests per second
  github:
    api_url: "https://api.github.com"
    advisories_url: "https://api.github.com/advisories"
    rate_limit: 30  # requests per minute

# SEMMA Pipeline Configuration
semma:
  sample:
    stratified_sampling: true
    sample_ratio: 0.3
    min_samples_per_class: 100
  
  explore:
    generate_visualizations: true
    correlation_threshold: 0.7
    outlier_detection: true
  
  modify:
    handle_missing: "median"  # mean, median, mode, drop
    normalize: true
    feature_selection: true
    min_feature_importance: 0.05
  
  model:
    algorithms:
      - "random_forest"
      - "svm"
      - "decision_tree"
      - "neural_network"
      - "xgboost"
      - "kmeans"
      - "isolation_forest"
    
    random_forest:
      n_estimators: 200
      max_depth: 20
      min_samples_split: 5
      min_samples_leaf: 2
    
    svm:
      kernel: "rbf"
      C: 1.0
      gamma: "scale"
    
    decision_tree:
      max_depth: 15
      min_samples_split: 10
    
    neural_network:
      hidden_layers: [128, 64, 32]
      activation: "relu"
      dropout: 0.3
      epochs: 50
      batch_size: 32
    
    xgboost:
      n_estimators: 150
      max_depth: 10
      learning_rate: 0.1
    
    kmeans:
      n_clusters: 5
      max_iter: 300
    
    isolation_forest:
      contamination: 0.1
      max_samples: "auto"
  
  assess:
    metrics:
      - "accuracy"
      - "precision"
      - "recall"
      - "f1_score"
      - "roc_auc"
      - "confusion_matrix"
    cross_validation:
      enabled: true
      folds: 5
    interpretability:
      shap_enabled: true
      lime_enabled: true

# Feature Engineering
features:
  code_metrics:
    - "cyclomatic_complexity"
    - "lines_of_code"
    - "number_of_functions"
    - "number_of_classes"
    - "comment_ratio"
    - "code_duplication"
    - "nesting_depth"
  
  vulnerability_indicators:
    - "unsafe_function_usage"
    - "deprecated_api_calls"
    - "input_validation_missing"
    - "authentication_issues"
    - "encryption_missing"
  
  text_features:
    vectorizer: "tfidf"  # tfidf, count, word2vec
    max_features: 5000
    ngram_range: [1, 3]

# CI/CD Integration
cicd:
  enabled: true
  scan_on_commit: true
  scan_on_pr: true
  
  thresholds:
    vulnerability_probability: 0.7
    high_risk: 0.85
    critical_risk: 0.95
  
  actions:
    create_issue: true
    block_merge: false  # Set to true in production
    notify_slack: false
    generate_report: true
  
  report:
    format: "html"  # html, json, markdown
    include_shap: true
    include_recommendations: true

# Logging
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "/app/logs/vulnerability_detection.log"
  max_bytes: 10485760  # 10MB
  backup_count: 5

# Model Persistence
model:
  save_path: "/app/models"
  versioning: true
  format: "joblib"  # joblib, pickle, h5
  auto_save: true

# Performance
performance:
  n_jobs: -1  # Use all CPU cores
  random_state: 42
  cache_enabled: true
  cache_size: 1000  # MB
